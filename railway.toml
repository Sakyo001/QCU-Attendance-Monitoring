# Railway deployment configuration
# Docs: https://docs.railway.app/reference/config-as-code

[build]
# Use the facenet-specific Dockerfile (avoids conflict with Next.js root)
builder = "dockerfile"
dockerfilePath = "Dockerfile.facenet"

[deploy]
# Railway injects PORT automatically — no need to set it here
startCommand = "python facenet-server.py"

# /health returns JSON quickly without loading heavy models (just checks status)
healthcheckPath = "/health"

# /health returns 200 immediately (model loads in background)
# so a short timeout is fine — Railway marks healthy within seconds
healthcheckTimeout = 30

restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
